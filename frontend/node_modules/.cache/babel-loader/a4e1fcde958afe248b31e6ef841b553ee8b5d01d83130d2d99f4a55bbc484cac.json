{"ast":null,"code":"import{ref,push,get,onValue,onChildAdded,off}from\"firebase/database\";import{auth}from\"./firebase_f.ts\";// Firebaseの認証インスタンスをインポート\nimport{db}from\"./firebase_f.ts\";// Firebase初期化ファイルからデータベースをインポート\nimport{calculateBattleResult}from\"./firebase-functions-client.ts\";//#region HomeView\n// プレイヤーデータを監視\nexport const onRoomPlayersUpdated=(roomId,callback,stop)=>{const roomRef=ref(db,`rooms/${roomId}/players`);const listener=onValue(roomRef,snapshot=>{if(stop.current){// `stop` が `true` の場合、リスナーを解除して終了\noff(roomRef,\"value\",listener);console.log(\"リスナーが解除されました\");return;}const PlayerData=snapshot.val();// RoomData型にキャスト\nif(PlayerData){console.log(\"プレイヤーデータが更新されました。\",PlayerData);callback(PlayerData);// データがある場合はコールバックを呼び出す\n}else{console.error(\"ルームが存在しません。\");callback(null);}},error=>{console.error(\"ルームデータの監視中にエラーが発生しました:\",error);callback(null);});return()=>{console.log(\"off onRoomPlayersUpdated\");off(roomRef,\"value\",listener);};};// export const stopOnRoomPlayers = (roomId: string) => {\n//   const roomRef = ref(db, `rooms/${roomId}/players`);\n//   off(roomRef);\n//   console.log(\"addPlayerの監視を停止しました。\");\n// };\n// ルームのデータを監視\nexport const onRoomUpdate=(roomId,callback,stop)=>{const roomRef=ref(db,`rooms/${roomId}`);const listener=onValue(roomRef,snapshot=>{if(stop.current){off(roomRef,\"value\",listener);console.log(\"リスナーが解除されました111\");return;}const roomData=snapshot.val();// RoomData型にキャスト\nif(roomData){console.log(\"ルームデータが更新されました。\",roomData);callback(roomData);// データがある場合はコールバックを呼び出す\n}else{console.error(\"ルームが存在しません。\");callback(null);}},error=>{console.error(\"ルームデータの監視中にエラーが発生しました:\",error);callback(null);});return()=>{console.log(\"リスナーが解除されました222\");off(roomRef,\"value\",listener);};};// ルームデータを取得する関数\nexport const getRoomData=async roomId=>{try{const roomRef=ref(db,`rooms/${roomId}`);const snapshot=await get(roomRef);if(snapshot.exists()){const roomData=snapshot.val();console.log(\"ルームデータを取得しました:\",roomData);return roomData;// RoomData型にキャストして返す\n}else{console.error(\"ルームが存在しません\");return null;}}catch(error){console.error(\"ルームデータの取得に失敗しました:\",error);return null;}};//#endregion\n//#region BattleView\n//#region メッセージ\n// メッセージを送信する関数\nexport const sendMessage=async(roomId,message)=>{const user=auth.currentUser;if(!user){throw new Error(\"ログインしていないユーザーです。\");}const messageRef=ref(db,`rooms/${roomId}/battleLog/messages`);console.log(\"メッセージ:\",message);const messageData={senderId:user.uid,message,timestamp:Date.now()};https:await push(messageRef,messageData);console.log(\"メッセージを送信しました。\",messageData);};export const onMessageAdded=(roomId,callback)=>{// メッセージリストの参照\nconst messagesRef=ref(db,`rooms/${roomId}/battleLog/messages`);// メッセージが追加されたときの監視\nonChildAdded(messagesRef,snapshot=>{const newMessage=snapshot.val();console.log(\"メッセージが追加されました。\",newMessage);callback(newMessage);// 新しいメッセージをコールバックで返す\n});};//#endregion\n//#region バトル終了時\n// 回答を送信する関数\nexport const sendAnswer=async(roomId,answer)=>{const user=auth.currentUser;if(!user){throw new Error(\"ログインしていないユーザーです。\");}const answerRef=ref(db,`rooms/${roomId}/battleLog/submittedAnswers`);await push(answerRef,answer);console.log(\"回答を送信しました。\",answer);};// 両プレイヤーの回答が揃ったらサーバーレス関数でスコア計算する\nexport const checkAnswers=roomId=>{const user=auth.currentUser;if(!user){throw new Error(\"ログインしていないユーザーです。\");}// メッセージリストの参照\nconst answerRef=ref(db,`rooms/${roomId}/battleLog/submittedAnswers`);// 両プレイヤーの選択が揃ったか確認\nget(answerRef).then(answersSnapshot=>{if(Object.keys(answersSnapshot.val()).length==2){console.log(\"両プレイヤーの回答が揃いました。\",answersSnapshot.val());calculateBattleResult(roomId);//awaitしない\n}else{// 要素数が2未満の場合、リスナーを設定して監視\nonValue(answerRef,snapshot=>{const updatedData=snapshot.val();const updatedCount=updatedData?Object.keys(updatedData).length:0;// 2つになったタイミングで `func()` を実行し、リスナーを解除\nif(updatedCount>=2){calculateBattleResult(roomId);//awaitしない\noff(answerRef);// リスナーを解除\nconsole.log(\"off checkAnswers\");}});}}).catch(error=>{console.error(\"回答の確認中にエラーが発生しました:\",error);});};//resultが更新されたらバトル終了\nexport const onResultUpdated=(roomId,playerNumber,callback)=>{const resultRef=ref(db,`rooms/${roomId}/battleLog/result`);const listener=onValue(resultRef,snapshot=>{const serverData=snapshot.val();// RoomData型にキャスト\nif(serverData){var _auth$currentUser;console.log(\"バトル結果が更新されました。\",serverData);const result={playerId:((_auth$currentUser=auth.currentUser)===null||_auth$currentUser===void 0?void 0:_auth$currentUser.uid)||\"\",myAnswer:serverData.answers[playerNumber],opponentAnswer:playerNumber===0?serverData.answers[1]:serverData.answers[0],corrects:serverData.corrects,win:playerNumber===0?serverData.scores[0]>serverData.scores[1]?\"win\":serverData.scores[0]<serverData.scores[1]?\"lose\":\"draw\":serverData.scores[1]>serverData.scores[0]?\"win\":serverData.scores[1]<serverData.scores[0]?\"lose\":\"draw\",score:playerNumber===0?serverData.scores[0]:serverData.scores[1],time:serverData.time};callback(result);}else{console.log(\"no result data\");callback(null);}},error=>{console.error(\"ルームデータの監視中にエラーが発生しました:\",error);callback(null);});return()=>{console.log(\"off onResultUpdated\");off(resultRef,\"value\",listener);};};//#endregion","map":{"version":3,"names":["ref","push","get","onValue","onChildAdded","off","auth","db","calculateBattleResult","onRoomPlayersUpdated","roomId","callback","stop","roomRef","listener","snapshot","current","console","log","PlayerData","val","error","onRoomUpdate","roomData","getRoomData","exists","sendMessage","message","user","currentUser","Error","messageRef","messageData","senderId","uid","timestamp","Date","now","https","onMessageAdded","messagesRef","newMessage","sendAnswer","answer","answerRef","checkAnswers","then","answersSnapshot","Object","keys","length","updatedData","updatedCount","catch","onResultUpdated","playerNumber","resultRef","serverData","_auth$currentUser","result","playerId","myAnswer","answers","opponentAnswer","corrects","win","scores","score","time"],"sources":["/Users/ryotarooda/Desktop/卒論/TuringChats/turing-chat-d/turing-chat-d11/frontend/src/services/firebase-realtime-database.ts"],"sourcesContent":["import {\n  ref,\n  push,\n  get,\n  onValue,\n  remove,\n  child,\n  onChildAdded,\n  off,\n} from \"firebase/database\";\nimport { auth } from \"./firebase_f.ts\"; // Firebaseの認証インスタンスをインポート\nimport { db } from \"./firebase_f.ts\"; // Firebase初期化ファイルからデータベースをインポート\nimport {\n  BattleLog,\n  BattleResult,\n  Message,\n  PlayerData,\n  ResultData,\n  RoomData,\n  SubmitAnswer,\n} from \"shared/dist/types\";\nimport { calculateBattleResult } from \"./firebase-functions-client.ts\";\n//#region HomeView\n// プレイヤーデータを監視\nexport const onRoomPlayersUpdated = (\n  roomId: string,\n  callback: (players: PlayerData[] | null) => void,\n  stop: { current: boolean }\n) => {\n  const roomRef = ref(db, `rooms/${roomId}/players`);\n  const listener = onValue(\n    roomRef,\n    (snapshot) => {\n      if (stop.current) {\n        // `stop` が `true` の場合、リスナーを解除して終了\n        off(roomRef, \"value\", listener);\n        console.log(\"リスナーが解除されました\");\n        return;\n      }\n      const PlayerData = snapshot.val() as PlayerData[] | null; // RoomData型にキャスト\n      if (PlayerData) {\n        console.log(\"プレイヤーデータが更新されました。\", PlayerData);\n        callback(PlayerData); // データがある場合はコールバックを呼び出す\n      } else {\n        console.error(\"ルームが存在しません。\");\n        callback(null);\n      }\n    },\n    (error) => {\n      console.error(\"ルームデータの監視中にエラーが発生しました:\", error);\n      callback(null);\n    }\n  );\n\n  return () => {\n    console.log(\"off onRoomPlayersUpdated\");\n    off(roomRef, \"value\", listener);\n  };\n};\n\n// export const stopOnRoomPlayers = (roomId: string) => {\n//   const roomRef = ref(db, `rooms/${roomId}/players`);\n//   off(roomRef);\n//   console.log(\"addPlayerの監視を停止しました。\");\n// };\n\n// ルームのデータを監視\nexport const onRoomUpdate = (\n  roomId: string,\n  callback: (roomData: RoomData | null) => void,\n  stop: { current: boolean }\n) => {\n  const roomRef = ref(db, `rooms/${roomId}`);\n  const listener = onValue(\n    roomRef,\n    (snapshot) => {\n      if (stop.current) {\n        off(roomRef, \"value\", listener);\n        console.log(\"リスナーが解除されました111\");\n        return;\n      }\n      const roomData = snapshot.val() as RoomData | null; // RoomData型にキャスト\n      if (roomData) {\n        console.log(\"ルームデータが更新されました。\", roomData);\n        callback(roomData); // データがある場合はコールバックを呼び出す\n      } else {\n        console.error(\"ルームが存在しません。\");\n        callback(null);\n      }\n    },\n    (error) => {\n      console.error(\"ルームデータの監視中にエラーが発生しました:\", error);\n      callback(null);\n    }\n  );\n  return () => {\n    console.log(\"リスナーが解除されました222\");\n    off(roomRef, \"value\", listener);\n  };\n};\n\n// ルームデータを取得する関数\nexport const getRoomData = async (roomId: string): Promise<RoomData | null> => {\n  try {\n    const roomRef = ref(db, `rooms/${roomId}`);\n    const snapshot = await get(roomRef);\n\n    if (snapshot.exists()) {\n      const roomData = snapshot.val();\n      console.log(\"ルームデータを取得しました:\", roomData);\n      return roomData as RoomData; // RoomData型にキャストして返す\n    } else {\n      console.error(\"ルームが存在しません\");\n      return null;\n    }\n  } catch (error) {\n    console.error(\"ルームデータの取得に失敗しました:\", error);\n    return null;\n  }\n};\n//#endregion\n\n//#region BattleView\n\n//#region メッセージ\n// メッセージを送信する関数\nexport const sendMessage = async (roomId: string, message: string) => {\n  const user = auth.currentUser;\n  if (!user) {\n    throw new Error(\"ログインしていないユーザーです。\");\n  }\n\n  const messageRef = ref(db, `rooms/${roomId}/battleLog/messages`);\n  console.log(\"メッセージ:\", message);\n  const messageData: Message = {\n    senderId: user.uid,\n    message,\n    timestamp: Date.now(),\n  };\n  https: await push(messageRef, messageData);\n  console.log(\"メッセージを送信しました。\", messageData);\n};\n\nexport const onMessageAdded = (\n  roomId: string,\n  callback: (data: any) => void\n) => {\n  // メッセージリストの参照\n  const messagesRef = ref(db, `rooms/${roomId}/battleLog/messages`);\n\n  // メッセージが追加されたときの監視\n  onChildAdded(messagesRef, (snapshot) => {\n    const newMessage = snapshot.val();\n    console.log(\"メッセージが追加されました。\", newMessage);\n    callback(newMessage); // 新しいメッセージをコールバックで返す\n  });\n};\n\n//#endregion\n\n//#region バトル終了時\n// 回答を送信する関数\nexport const sendAnswer = async (roomId: string, answer: SubmitAnswer) => {\n  const user = auth.currentUser;\n  if (!user) {\n    throw new Error(\"ログインしていないユーザーです。\");\n  }\n\n  const answerRef = ref(db, `rooms/${roomId}/battleLog/submittedAnswers`);\n  await push(answerRef, answer);\n  console.log(\"回答を送信しました。\", answer);\n};\n\n// 両プレイヤーの回答が揃ったらサーバーレス関数でスコア計算する\nexport const checkAnswers = (roomId: string) => {\n  const user = auth.currentUser;\n  if (!user) {\n    throw new Error(\"ログインしていないユーザーです。\");\n  }\n  // メッセージリストの参照\n  const answerRef = ref(db, `rooms/${roomId}/battleLog/submittedAnswers`);\n  // 両プレイヤーの選択が揃ったか確認\n  get(answerRef)\n    .then((answersSnapshot) => {\n      if (Object.keys(answersSnapshot.val()).length == 2) {\n        console.log(\"両プレイヤーの回答が揃いました。\", answersSnapshot.val());\n        calculateBattleResult(roomId); //awaitしない\n      } else {\n        // 要素数が2未満の場合、リスナーを設定して監視\n        onValue(answerRef, (snapshot) => {\n          const updatedData = snapshot.val();\n          const updatedCount = updatedData\n            ? Object.keys(updatedData).length\n            : 0;\n\n          // 2つになったタイミングで `func()` を実行し、リスナーを解除\n          if (updatedCount >= 2) {\n            calculateBattleResult(roomId); //awaitしない\n            off(answerRef); // リスナーを解除\n            console.log(\"off checkAnswers\");\n          }\n        });\n      }\n    })\n    .catch((error) => {\n      console.error(\"回答の確認中にエラーが発生しました:\", error);\n    });\n};\n\n//resultが更新されたらバトル終了\nexport const onResultUpdated = (\n  roomId: string,\n  playerNumber: number,\n  callback: (players: ResultData | null) => void\n) => {\n  const resultRef = ref(db, `rooms/${roomId}/battleLog/result`);\n  const listener = onValue(\n    resultRef,\n    (snapshot) => {\n      const serverData = snapshot.val() as BattleResult; // RoomData型にキャスト\n      if (serverData) {\n        console.log(\"バトル結果が更新されました。\", serverData);\n        const result: ResultData = {\n          playerId: auth.currentUser?.uid || \"\",\n          myAnswer: serverData.answers[playerNumber],\n          opponentAnswer:\n            playerNumber === 0 ? serverData.answers[1] : serverData.answers[0],\n          corrects: serverData.corrects,\n          win:\n            playerNumber === 0\n              ? serverData.scores[0] > serverData.scores[1]\n                ? \"win\"\n                : serverData.scores[0] < serverData.scores[1]\n                  ? \"lose\"\n                  : \"draw\"\n              : serverData.scores[1] > serverData.scores[0]\n                ? \"win\"\n                : serverData.scores[1] < serverData.scores[0]\n                  ? \"lose\"\n                  : \"draw\",\n          score:\n            playerNumber === 0 ? serverData.scores[0] : serverData.scores[1],\n          time: serverData.time,\n        };\n        callback(result);\n      } else {\n        console.log(\"no result data\");\n        callback(null);\n      }\n    },\n    (error) => {\n      console.error(\"ルームデータの監視中にエラーが発生しました:\", error);\n      callback(null);\n    }\n  );\n  return () => {\n    console.log(\"off onResultUpdated\");\n    off(resultRef, \"value\", listener);\n  };\n};\n\n//#endregion\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}